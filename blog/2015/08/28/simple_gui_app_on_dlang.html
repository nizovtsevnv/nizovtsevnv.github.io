<!DOCTYPE html> <html> <head> <meta charset=UTF-8> <meta content='text/html; charset=UTF-8' http-equiv=content-type> <meta content='IE=edge' http-equiv=X-UA-Compatible> <meta content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no' name=viewport> <link rel=alternate type="application/atom+xml" title="Atom Feed" href="/feed.xml"/> <title>Простое GUI(GTK) приложение на Dlang</title> <link href='apple-touch-icon-152x152-precomposed.png' rel=apple-touch-icon sizes=152x152> <link href='apple-touch-icon-144x144-precomposed.png' rel=apple-touch-icon sizes=144x144> <link href='apple-touch-icon-114x114-precomposed.png' rel=apple-touch-icon sizes=114x114> <link href='apple-touch-icon-72x72-precomposed.png' rel=apple-touch-icon sizes=72x72> <link href='apple-touch-icon-precomposed.png' rel=apple-touch-icon> <link href='favicon.png' rel='shortcut icon'> <link href='favicon.ico' rel=icon type='image/ico'> <link href="../../../../stylesheets/application.css" rel=stylesheet /> <script src="../../../../javascripts/jquery.js"></script><script src="../../../../javascripts/application.js"></script> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-7867765-20', 'auto');
      ga('send', 'pageview');
    </script> </head> <body class='blog blog_2015 blog_2015_08 blog_2015_08_28 blog_2015_08_28_simple_gui_app_on_dlang'> <div id=page-header> <nav class=navbar> <a class='navbar-brand hidden-xs-down' href='/'>Николай Низовцев</a> <ul class='nav navbar-nav pull-xs-right'> <li class=nav-item> <a class=nav-link href='/'>EN</a> </li> <li class=nav-item> <a class=nav-link href='/ru'>RU</a> </li> </ul> </nav> </div> <div class=container-fluid> <div class=row id=page-tags> <div class='col-xl-6 offset-xl-3 col-lg-8 offset-lg-2 col-md-12 col-sm-12 col-xs-12'> <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/новости'>новости</a> </span> <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/news'>news</a> </span> <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/life'>life</a> </span> <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/travel'>travel</a> </span> <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/thailand'>thailand</a> </span> <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/dlang'>dlang</a> </span> <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/аналитика'>аналитика</a> </span> <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/общество'>общество</a> </span> </div> </div> <div class=row id=page-main> <div class='col-xl-6 offset-xl-3 col-lg-8 offset-lg-2 col-md-12 col-sm-12 col-xs-12'> <div class=article> <h2>Простое GUI(GTK) приложение на Dlang</h2> <p class=meta> Aug 28 2015 <span class='tag tag-default'> <i aria-hidden=true class='fa fa-tag'></i> <a href='/blog/tags/dlang'>dlang</a> </span> </p> <div class=content> <p> В этой статье я покажу пример каркаса приложения, которое программно создаёт основное окно, диалоговое окно About, меню и связывает его с открытием диалогового окна и завершением приложения. </p> <p> Для сборки приложения нам понадобится стандартный менеджер пакетов <a href='http://code.dlang.org/getting_started' target=blank>DUB</a> . </p> <p>Справочные материалы по библиотекам используемым в этой статье можно найти по адресам:</p> <ul> <li> <a href='http://dlang.org/phobos' target=blank>Документация по стандартной библиотеке языка D "Phobos"</a> </li> <li> <a href='https://github.com/D-Programming-Language/phobos' target=blank>Проект Phobos на Github</a> </li> <li> <a href='http://api.gtkd.org' target=blank>Документация по обёртке GTKd</a> </li> <li> <a href='https://github.com/gtkd-developers/GtkD' target=blank>Проект GTKd на Github</a> </li> </ul> <p>Начнём...</p> <pre class="highlight cpp"><code>&#x000A;<span class="kt">void</span> <span class="n">main</span><span class="p">(</span><span class="n">string</span><span class="p">[]</span> <span class="n">argv</span><span class="p">){</span>&#x000A;  <span class="n">UI</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">argv</span><span class="p">);</span>&#x000A;<span class="p">}</span>&#x000A;&#x000A;<span class="k">class</span> <span class="nc">UI</span><span class="p">{</span>&#x000A;  <span class="n">import</span> <span class="n">gtk</span><span class="p">.</span><span class="n">AboutDialog</span><span class="p">,</span>&#x000A;         <span class="n">gtk</span><span class="p">.</span><span class="n">Main</span><span class="p">,</span>&#x000A;         <span class="n">gtk</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">,</span>&#x000A;         <span class="n">gtk</span><span class="p">.</span><span class="n">Menu</span><span class="p">,</span>&#x000A;         <span class="n">gtk</span><span class="p">.</span><span class="n">MenuBar</span><span class="p">,</span>&#x000A;         <span class="n">gtk</span><span class="p">.</span><span class="n">MenuItem</span><span class="p">,</span>&#x000A;         <span class="n">gtk</span><span class="p">.</span><span class="n">VBox</span><span class="p">;</span>&#x000A;&#x000A;  <span class="k">static</span> <span class="k">private</span> <span class="n">MainWindow</span> <span class="n">window</span><span class="p">;</span>&#x000A;  <span class="k">static</span> <span class="k">private</span> <span class="n">AboutDialog</span> <span class="n">about_dialog</span><span class="p">;</span>&#x000A;&#x000A;  <span class="c1">// Создаём и выводим элементы пользовательского интерфейса&#x000A;</span>  <span class="k">static</span> <span class="k">private</span> <span class="kt">void</span> <span class="n">build</span><span class="p">(){</span>&#x000A;    <span class="c1">// Создаём пункт меню "Выход" и привязываем к нему метод для закрытия окна приложения&#x000A;</span>    <span class="k">auto</span> <span class="n">exit_menu_item</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MenuItem</span><span class="p">(</span><span class="s">"Выход"</span><span class="p">);</span>&#x000A;    <span class="n">exit_menu_item</span><span class="p">.</span><span class="n">addOnActivate</span><span class="p">(</span><span class="n">delegate</span> <span class="kt">void</span><span class="p">(</span><span class="n">MenuItem</span> <span class="n">item</span><span class="p">){</span>&#x000A;      <span class="n">terminate</span><span class="p">();</span>&#x000A;    <span class="p">});</span>&#x000A;&#x000A;    <span class="c1">// Создаём субменю и пункт меню "Файл", добавляем в него "Выход"&#x000A;</span>    <span class="k">auto</span> <span class="n">file_menu</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Menu</span><span class="p">();</span>&#x000A;    <span class="n">file_menu</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">exit_menu_item</span><span class="p">);</span>&#x000A;    <span class="k">auto</span> <span class="n">file_menu_item</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MenuItem</span><span class="p">(</span><span class="s">"Файл"</span><span class="p">);</span>&#x000A;    <span class="n">file_menu_item</span><span class="p">.</span><span class="n">setSubmenu</span><span class="p">(</span><span class="n">file_menu</span><span class="p">);</span>&#x000A;&#x000A;    <span class="c1">// Создаём пункт меню "О Программе" и привязываем к нему метод для открытия диалогового окна&#x000A;</span>    <span class="k">auto</span> <span class="n">about_menu_item</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MenuItem</span><span class="p">(</span><span class="s">"О Программе"</span><span class="p">);</span>&#x000A;    <span class="n">about_menu_item</span><span class="p">.</span><span class="n">addOnActivate</span><span class="p">(</span><span class="n">delegate</span> <span class="kt">void</span><span class="p">(</span><span class="n">MenuItem</span> <span class="n">item</span><span class="p">){</span>&#x000A;      <span class="n">about_dialog</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>&#x000A;    <span class="p">});</span>&#x000A;&#x000A;    <span class="c1">// Создаём список меню и пункт меню "Помощь", добавляем в него "О Программе"&#x000A;</span>    <span class="k">auto</span> <span class="n">help_menu</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Menu</span><span class="p">();</span>&#x000A;    <span class="n">help_menu</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">about_menu_item</span><span class="p">);</span>&#x000A;    <span class="k">auto</span> <span class="n">help_menu_item</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MenuItem</span><span class="p">(</span><span class="s">"Помощь"</span><span class="p">);</span>&#x000A;    <span class="n">help_menu_item</span><span class="p">.</span><span class="n">setSubmenu</span><span class="p">(</span><span class="n">help_menu</span><span class="p">);</span>&#x000A;&#x000A;    <span class="c1">// Создаём панель меню и добавляем на неё "Файл", "Помощь"&#x000A;</span>    <span class="k">auto</span> <span class="n">menu</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MenuBar</span><span class="p">();</span>&#x000A;    <span class="n">menu</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_menu_item</span><span class="p">);</span>&#x000A;    <span class="n">menu</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">help_menu_item</span><span class="p">);</span>&#x000A;&#x000A;    <span class="c1">// Создаём контейнер для элементов и добавляем в него главное меню&#x000A;</span>    <span class="c1">// false - указывает контейнеру на разнородность размеров площадей выделяемых элементам&#x000A;</span>    <span class="k">auto</span> <span class="n">root_container</span> <span class="o">=</span> <span class="k">new</span> <span class="n">VBox</span><span class="p">(</span><span class="nb">false</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>&#x000A;    <span class="c1">// packStart - чтобы меню "прилипло" сверху контейнера&#x000A;</span>    <span class="c1">// ...false, false - чтобы меню не было растянуто вертикально по окну&#x000A;</span>    <span class="n">root_container</span><span class="p">.</span><span class="n">packStart</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>&#x000A;&#x000A;    <span class="c1">// Создаём диалоговое окно и устанавливаем несколько встроенных значений&#x000A;</span>    <span class="n">about_dialog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AboutDialog</span><span class="p">();</span>&#x000A;    <span class="n">about_dialog</span><span class="p">.</span><span class="n">setProgramName</span><span class="p">(</span><span class="s">"GTKd Template"</span><span class="p">);</span>&#x000A;    <span class="n">about_dialog</span><span class="p">.</span><span class="n">setVersion</span><span class="p">(</span><span class="s">"0.1"</span><span class="p">);</span>&#x000A;&#x000A;    <span class="c1">// Создаём основное окно приложения и добавляем в него контейнер с ранее добавленными элементами&#x000A;</span>    <span class="n">window</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MainWindow</span><span class="p">(</span><span class="s">"GTKd Template"</span><span class="p">);</span>&#x000A;    <span class="n">window</span><span class="p">.</span><span class="n">setDefaultSize</span><span class="p">(</span><span class="mi">750</span><span class="p">,</span> <span class="mi">550</span><span class="p">);</span>&#x000A;    <span class="n">window</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">root_container</span><span class="p">);</span>&#x000A;    <span class="n">window</span><span class="p">.</span><span class="n">showAll</span><span class="p">();</span>&#x000A;  <span class="p">}</span>&#x000A;&#x000A;  <span class="k">static</span> <span class="kt">void</span> <span class="n">run</span><span class="p">(</span><span class="n">string</span><span class="p">[]</span> <span class="n">argv</span><span class="p">){</span>&#x000A;    <span class="n">Main</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">argv</span><span class="p">);</span>&#x000A;    <span class="n">build</span><span class="p">();</span>&#x000A;    <span class="n">Main</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>&#x000A;  <span class="p">}</span>&#x000A;&#x000A;  <span class="k">static</span> <span class="kt">void</span> <span class="n">terminate</span><span class="p">(){</span>&#x000A;    <span class="n">window</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>&#x000A;  <span class="p">}</span>&#x000A;<span class="p">}</span>&#x000A;</code></pre> </div> </div> </div> </div> </div> <div id=page-footer> <div class=container-fluid> <div class=row> <div class='col-xl-6 offset-xl-3 col-lg-6 offset-lg-3 col-md-12 center'> <a class=img href='https://www.linkedin.com/in/nizovtsevnv' target=blank> <img src='../../../../images/socials/linkedin.png'> </a> <a class=img href='https://www.facebook.com/nick.nizovtsev' target=blank> <img src='../../../../images/socials/facebook.png'> </a> <a class=img href='https://twitter.com/nizovtsevnv' target=blank> <img src='../../../../images/socials/twitter.png'> </a> <a class=img href='https://vk.com/nizovtsevnv' target=blank> <img src='../../../../images/socials/vk.png'> </a> <a class=img href='https://www.instagram.com/nizovtsevnv/' target=blank> <img src='../../../../images/socials/instagram.png'> </a> </div> <div class='col-xl-3 col-md-12 right'> <p class=rss-subscribe> subscribe <a href='/feed.xml'>via RSS</a> </p> </div> </div> </div> </div> </body> </html>